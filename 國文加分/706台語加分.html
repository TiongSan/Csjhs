<!DOCTYPE html>
<!-- saved from url=(0117)https://filedn.com/laMtL9jmKf7JrDEQG0A6OPy/html/%E8%AA%B2%E5%A0%82%E5%8A%A0%E5%88%86-%E5%8A%A0%E5%BC%B7%E7%89%88.html -->
<html lang="en"><div id="scroll_div" style="width: 100px; height: 100px; overflow: scroll; position: absolute; top: -9999px;"></div><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>706課堂加分系統</title>
    <style>
        body {
            font-family: 'Roboto', sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 0;
            padding: 20px;
            background: linear-gradient(to right, #ffecd2, #fcb69f);
            color: #444;
        }
        h1 {
            margin: 0;
            padding: 20px 0;
            font-size: 3em;
            color: #fff;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }
        #header {
            width: 100%;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
        }
        #calendar {
            width: 80%;
            background-color: rgba(255, 255, 255, 0.8);
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
            backdrop-filter: blur(10px);
            margin-top: 20px;
        }
        #calendarHeader {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
            color: #fff;
        }
        #calendarHeader button {
            background: #ff7e5f;
            color: #fff;
            border: none;
            border-radius: 5px;
            padding: 10px 20px;
            font-size: 1.2em;
            cursor: pointer;
            transition: background 0.3s ease;
        }
        #calendarHeader button:hover {
            background: #feb47b;
        }
        #calendarMonth {
            color: #FFA500; /* 橘色字 */
        }
        #calendarDays {
            display: grid;
            grid-template-columns: repeat(8, 1fr); /* 7 days + 1 for weekly summary */
            gap: 10px;
            text-align: center;
        }
        .calendarDay {
            padding: 15px;
            border: 2px solid #ff7e5f;
            border-radius: 10px;
            text-align: center;
            cursor: pointer;
            background: rgba(255, 255, 255, 0.7);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease, background 0.3s ease;
        }
        .calendarDay:hover {
            background: rgba(255, 255, 255, 1);
            transform: scale(1.05);
        }
        .calendarHeaderDay {
            font-weight: bold;
            font-size: 1.25em; /* Increase font size by 5px */
            text-align: center;
            color: #ff7e5f;
        }
        .today {
            font-size: 1.5em;
            color: #d32f2f;
            font-weight: bold;
        }
        .hasData {
            background-color: rgba(173, 216, 230, 0.8);
        }
        #studentNamesInput {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(255, 255, 255, 0.9);
            padding: 30px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
            border-radius: 10px;
            z-index: 1000;
            backdrop-filter: blur(10px);
        }
        #studentNamesInput h3 {
            margin-bottom: 20px;
            color: #444;
        }
        #studentNamesInput textarea {
            width: 100%;
            height: 150px;
            margin-bottom: 20px;
            font-size: 1em;
            padding: 15px;
            border: 1px solid #ccc;
            border-radius: 5px;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.1);
        }
        #studentNamesInput button {
            padding: 10px 20px;
            font-size: 1em;
            cursor: pointer;
            border: none;
            border-radius: 5px;
            background: #ff7e5f;
            color: #fff;
            transition: background 0.3s ease;
        }
        #studentNamesInput button:hover {
            background: #feb47b;
        }
        #studentNamesInputOverlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 999;
        }
        #groupSettings {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(255, 255, 255, 0.9);
            padding: 30px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
            border-radius: 10px;
            z-index: 1000;
            backdrop-filter: blur(10px);
        }
        #groupSettings h3 {
            margin-bottom: 20px;
            color: #444;
        }
        #groupSettings input {
            width: 100%;
            padding: 10px;
            margin-bottom: 20px;
            font-size: 1em;
            border: 1px solid #ccc;
            border-radius: 5px;
        }
        #groupSettings button {
            padding: 10px 20px;
            font-size: 1em;
            cursor: pointer;
            border: none;
            border-radius: 5px;
            background: #ff7e5f;
            color: #fff;
            transition: background 0.3s ease;
        }
        #groupSettings button:hover {
            background: #feb47b;
        }
        #groupSettingsOverlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 999;
        }
        #inputSection {
            display: none;
            width: 80%;
            margin-top: 20px;
            text-align: center; /* 讓標題及表格在畫面上左右置中對齊 */
        }
        textarea {
            width: 300px;
            height: 150px;
            margin-bottom: 10px;
            font-size: 1em;
            padding: 15px;
            border: 1px solid #ccc;
            border-radius: 5px;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.1);
        }
        button {
            padding: 10px 20px;
            font-size: 1em;
            cursor: pointer;
            border: none;
            border-radius: 5px;
            background-color: #800080;
            color: white;
            margin: 5px;
            transition: background 0.3s ease;
        }
        button:hover {
            background-color: #9b59b6;
        }
        .resetButton {
            background-color: red;
        }
        .resetButton:hover {
            background-color: darkred;
        }
        .monthlySummaryButton {
            background-color: green;
        }
        .monthlySummaryButton:hover {
            background-color: darkgreen;
        }
        .exportButton, .importButton {
            font-size: 12px;
            background-color: #4682B4;
        }
        .exportButton:hover, .importButton:hover {
            background-color: #5a9bd4;
        }
        .scoreTable {
            margin-top: 20px;
            border-collapse: collapse;
            display: inline-block;
            vertical-align: top;
            background-color: rgba(255, 255, 255, 0.9);
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
            backdrop-filter: blur(10px);
            text-align: center; /* 讓標題及表格在畫面上左右置中對齊 */
        }
        .groupScoreTable {
            margin-top: 20px;
            border-collapse: collapse;
            display: inline-block;
            vertical-align: top;
            background-color: rgba(144, 238, 144, 0.9); /* 淡綠色背景 */
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
            backdrop-filter: blur(10px);
            text-align: center;
        }
        .scoreTable, .scoreTable th, .scoreTable td,
        .groupScoreTable, .groupScoreTable th, .groupScoreTable td {
            border: 1px solid #ddd;
        }
        .scoreTable th, .scoreTable td,
        .groupScoreTable th, .groupScoreTable td {
            padding: 10px;
            text-align: center;
        }
        .scoreTable td button,
        .groupScoreTable td button {
            padding: 5px 10px;
            font-size: 12px;
            background-color: #ff7e5f;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background 0.3s ease;
        }
        .scoreTable td button:hover,
        .groupScoreTable td button:hover {
            background-color: #feb47b;
        }
        .highlight {
            font-weight: bold;
            color: red;
        }
        #chart {
            margin-top: 20px;
            width: 100%;
            max-width: 1000px;
        }
        #controlSection {
            margin-top: 20px;
            text-align: center;
            width: 100%;
        }
        #footer {
            position: fixed;
            bottom: 10px;
            right: 10px;
            font-size: 14px;
        }
        #footer a {
            color: #fff;
            text-decoration: none;
        }
        #footer a:hover {
            text-decoration: underline;
        }
        .batchControl {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-top: 20px;
        }
        .batchControl input {
            margin: 0 10px;
            padding: 5px;
            font-size: 16px;
            width: 60px;
            text-align: center;
        }
        #selectedDate {
            margin-top: 10px;
            font-size: 1.5em;
            font-weight: bold;
        }
        .weekSummaryButton {
            font-size: 13px;
            background-color: #add8e6;
            border: none;
            cursor: pointer;
            padding: 5px 10px;
            border-radius: 5px;
            transition: background 0.3s ease;
        }
        .weekSummaryButton:hover {
            background-color: #87ceeb;
        }
        #weeklySummaryOverlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            justify-content: center;
            align-items: center;
        }
        #weeklySummaryContent {
            background: rgba(255, 255, 255, 0.9);
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(10px);
        }
        .control-buttons {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 10px;
            gap: 10px;
        }
        .bottom-buttons {
            position: fixed;
            bottom: 20px;
            left: 20px;
            display: flex;
            gap: 10px;
        }
        .themeButton {
            padding: 10px 20px;
            margin: 10px;
            border: none;
            border-radius: 5px;
            font-size: 1em;
            cursor: pointer;
            transition: background 0.3s ease, transform 0.3s ease;
        }
        .themeButton:hover {
            transform: scale(1.1);
        }
        .defaultTheme {
            background-color: #ff7e5f;
            color: white;
        }
        .defaultTheme:hover {
            background-color: #feb47b;
        }
        .techTheme1 {
            background-color: #0f2027;
            color: white;
        }
        .techTheme1:hover {
            background-color: #203a43;
        }
        .techTheme2 {
            background-color: #11998e;
            color: white;
        }
        .techTheme2:hover {
            background-color: #38ef7d;
        }
        .techTheme3 {
            background-color: #2980b9;
            color: white;
        }
        .techTheme3:hover {
            background-color: #6dd5fa;
        }
    </style>
</head>
<body style="background: linear-gradient(to right, rgb(255, 236, 210), rgb(252, 182, 159));">
    <div id="header" style="display: flex;">
        <button class="resetButton" onclick="confirmReset()">重置</button>
        <h1>課堂加分系統</h1>
        <div style="flex-grow: 1;"></div>
        <button onclick="showStudentNamesInput()" style="margin-right: 10px;">輸入學生姓名</button>
        <button id="groupSettingsButton" onclick="handleGroupSettings()">學生分組</button>
    </div>

    <!-- Initial Screen with Calendar -->
    <div id="calendar" style="display: block;">
        <div id="calendarHeader">
            <button onclick="changeMonth(-1)">上一個月</button>
            <h2 id="calendarMonth">2024年8月</h2>
            <button class="monthlySummaryButton" onclick="showMonthlySummary()">每月統計</button>
            <button onclick="changeMonth(1)">下一個月</button>
        </div>
        <div id="calendarDays">
                <div class="calendarHeaderDay">日</div>
                <div class="calendarHeaderDay">一</div>
                <div class="calendarHeaderDay">二</div>
                <div class="calendarHeaderDay">三</div>
                <div class="calendarHeaderDay">四</div>
                <div class="calendarHeaderDay">五</div>
                <div class="calendarHeaderDay">六</div>
                <div class="calendarHeaderDay">統計</div>
            <div class="calendarDay prevMonthDay">28</div><div class="calendarDay prevMonthDay">29</div><div class="calendarDay prevMonthDay">30</div><div class="calendarDay prevMonthDay">31</div><div class="calendarDay">1</div><div class="calendarDay">2</div><div class="calendarDay">3</div><div class="calendarDay"><button class="weekSummaryButton" onclick="showWeeklySummary(-3, 3)">每週統計</button></div><div class="calendarDay">4</div><div class="calendarDay">5</div><div class="calendarDay">6</div><div class="calendarDay">7</div><div class="calendarDay">8</div><div class="calendarDay">9</div><div class="calendarDay">10</div><div class="calendarDay"><button class="weekSummaryButton" onclick="showWeeklySummary(4, 10)">每週統計</button></div><div class="calendarDay">11</div><div class="calendarDay">12</div><div class="calendarDay">13</div><div class="calendarDay">14</div><div class="calendarDay">15</div><div class="calendarDay">16</div><div class="calendarDay">17</div><div class="calendarDay"><button class="weekSummaryButton" onclick="showWeeklySummary(11, 17)">每週統計</button></div><div class="calendarDay">18</div><div class="calendarDay">19</div><div class="calendarDay">20</div><div class="calendarDay">21</div><div class="calendarDay">22</div><div class="calendarDay">23</div><div class="calendarDay">24</div><div class="calendarDay"><button class="weekSummaryButton" onclick="showWeeklySummary(18, 24)">每週統計</button></div><div class="calendarDay">25</div><div class="calendarDay">26</div><div class="calendarDay">27</div><div class="calendarDay">28</div><div class="calendarDay">29</div><div class="calendarDay today">30</div><div class="calendarDay">31</div><div class="calendarDay"><button class="weekSummaryButton" onclick="showWeeklySummary(25, 31)">每週統計</button></div></div>
    </div>
    
    <!-- Student Names Input Overlay -->
    <div id="studentNamesInputOverlay" onclick="hideStudentNamesInput()"></div>
    <div id="studentNamesInput">
        <h3>輸入學生姓名，每一行一個名字</h3>
        <textarea id="studentNames" placeholder="每行輸入一個學生姓名"></textarea><br>
        <button onclick="submitNames()">送出</button>
    </div>

    <!-- Group Settings Overlay -->
    <div id="groupSettingsOverlay" onclick="hideGroupSettings()"></div>
    <div id="groupSettings">
        <h3>設定分組數量</h3>
        <input type="number" id="groupCount" min="1" placeholder="輸入分組數量"><br>
        <button onclick="submitGroupSettings()">送出</button>
        <button id="adjustGroupsButton" onclick="showGroupAdjustment()" style="display: none; margin-top: 10px;">調整分組</button>
    </div>
    
    <div id="inputSection">
        <div id="controlSection" class="control-buttons">
            <button onclick="showScoreSection()">加扣分</button>
            <button onclick="showChartSection()">呈現直條圖</button>
            <button onclick="goBack()">回上一頁</button>
        </div>
        <div id="selectedDate"></div>
        <div id="scoreSection"></div>
        <div id="groupScoreSection"></div>
        <div id="chartSection">
            <canvas id="chart"></canvas>
        </div>
    </div>

    <div id="weeklySummaryOverlay" onclick="hideWeeklySummary()">
        <div id="weeklySummaryContent" onclick="event.stopPropagation()">
            <h2>統計</h2>
            <div id="weeklyScoreSection"></div>
            <canvas id="weeklyChart"></canvas>
        </div>
    </div>

    <div class="bottom-buttons">
        <button class="exportButton" onclick="exportData()">匯出</button>
        <button class="importButton" onclick="importData()">匯入</button>
    </div>

    <div id="footer">
        Designed by <a href="https://kentxchang.blogspot.tw/" target="_blank">阿剛老師</a>
    </div>

    <!-- Theme Buttons -->
    <div id="themeButtons" style="margin-top: 100px; display: flex; justify-content: center;">
        <button class="themeButton defaultTheme" onclick="setTheme(&#39;default&#39;)">橙色陽光</button>
        <button class="themeButton techTheme1" onclick="setTheme(&#39;tech1&#39;)">深海之夢</button>
        <button class="themeButton techTheme2" onclick="setTheme(&#39;tech2&#39;)">綠野仙蹤</button>
        <button class="themeButton techTheme3" onclick="setTheme(&#39;tech3&#39;)">藍天白雲</button>
    </div>

    <script src="./806台語加分_files/chart.js.下載"></script>
    <script>
        const backgroundColors = {
            'default': 'linear-gradient(to right, #ffecd2, #fcb69f)',
            'tech1': 'linear-gradient(to right, #0f2027, #203a43, #2c5364)',
            'tech2': 'linear-gradient(to right, #11998e, #38ef7d)',
            'tech3': 'linear-gradient(to right, #2980b9, #6dd5fa, #ffffff)'
        };

        const fileName = window.location.pathname.split('/').pop().split('.')[0];
        const studentStorageKey = `${fileName}-students`;
        const scoreStorageKey = `${fileName}-scores`;
        const groupStorageKey = `${fileName}-groups`;
        const themeStorageKey = `${fileName}-currentTheme`;

        let students = JSON.parse(localStorage.getItem(studentStorageKey)) || [];
        let scores = JSON.parse(localStorage.getItem(scoreStorageKey)) || {};
        let groups = JSON.parse(localStorage.getItem(groupStorageKey)) || [];
        let chart;
        let weeklyChart;
        let currentMonth = new Date();
        let currentDay = null;
        let currentTheme = localStorage.getItem(themeStorageKey) || 'default';

        document.body.style.background = backgroundColors[currentTheme];
        document.getElementById('calendar').style.display = 'block';
        document.getElementById('header').style.display = 'flex';
        renderCalendar();

        function showStudentNamesInput() {
            document.getElementById('studentNamesInput').style.display = 'block';
            document.getElementById('studentNamesInputOverlay').style.display = 'block';
        }

        function hideStudentNamesInput() {
            document.getElementById('studentNamesInput').style.display = 'none';
            document.getElementById('studentNamesInputOverlay').style.display = 'none';
        }

        function handleGroupSettings() {
            if (hasGroupScores()) {
                alert('分組已有加扣分資料，不可調整分組。');
            } else {
                showGroupSettings();
            }
        }

        function showGroupSettings() {
            document.getElementById('groupSettings').style.display = 'block';
            document.getElementById('groupSettingsOverlay').style.display = 'block';
            const adjustGroupsButton = document.getElementById('adjustGroupsButton');
            if (groups.length > 0) {
                adjustGroupsButton.style.display = 'block';
            } else {
                adjustGroupsButton.style.display = 'none';
            }
        }

        function hideGroupSettings() {
            document.getElementById('groupSettings').style.display = 'none';
            document.getElementById('groupSettingsOverlay').style.display = 'none';
        }

        function submitNames() {
            const names = document.getElementById('studentNames').value.trim().split('\n').map(name => name.trim());
            names.forEach(name => {
                if (!students.includes(name) && name !== '') {
                    students.push(name);
                    if (groups.length > 0) {
                        addToSmallestGroup(name);  // 新增學生時自動加入人數最少的組別
                    }
                }
            });
            localStorage.setItem(studentStorageKey, JSON.stringify(students));
            localStorage.setItem(groupStorageKey, JSON.stringify(groups));
            hideStudentNamesInput();
            renderCalendar();
        }

        function addToSmallestGroup(student) {
            let smallestGroup = groups[0];
            groups.forEach(group => {
                if (group.length < smallestGroup.length) {
                    smallestGroup = group;
                }
            });
            smallestGroup.push(student);
        }

        function submitGroupSettings() {
            const groupCount = document.getElementById('groupCount').value;
            if (groupCount <= 0 || students.length === 0) return;
            
            groups = [];
            for (let i = 0; i < groupCount; i++) {
                groups.push([]);
            }
            
            students.forEach((student, index) => {
                groups[index % groupCount].push(student);
            });

            localStorage.setItem(groupStorageKey, JSON.stringify(groups));
            hideGroupSettings();
            showGroupAdjustment();
        }

        function showGroupAdjustment() {
            const overlay = document.createElement('div');
            overlay.style.position = 'fixed';
            overlay.style.top = '0';
            overlay.style.left = '0';
            overlay.style.width = '100%';
            overlay.style.height = '100%';
            overlay.style.backgroundColor = 'rgba(0, 0, 0, 0.5)';
            overlay.style.display = 'flex';
            overlay.style.justifyContent = 'center';
            overlay.style.alignItems = 'center';
            overlay.id = 'groupAdjustmentOverlay';
            document.body.appendChild(overlay);

            const container = document.createElement('div');
            container.style.backgroundColor = 'rgba(255, 255, 255, 0.9)';
            container.style.padding = '30px';
            container.style.borderRadius = '10px';
            container.style.width = '600px'; /* 設置寬度為600px */
            container.style.maxHeight = '80%';
            container.style.overflowY = 'auto';
            container.style.textAlign = 'center';
            container.style.backdropFilter = 'blur(10px)';

            const groupContainerGrid = document.createElement('div');
            groupContainerGrid.style.display = 'grid';
            groupContainerGrid.style.gridTemplateColumns = 'repeat(4, 1fr)'; /* 設置四欄布局 */
            groupContainerGrid.style.gap = '10px';

            groups.forEach((group, index) => {
                const groupContainer = document.createElement('div');
                groupContainer.style.marginBottom = '20px';

                const groupTitle = document.createElement('h3');
                groupTitle.textContent = `第 ${index + 1} 組`;
                groupContainer.appendChild(groupTitle);

                group.forEach(student => {
                    const studentItem = document.createElement('div');
                    studentItem.textContent = student;
                    studentItem.style.padding = '10px';
                    studentItem.style.margin = '5px';
                    studentItem.style.border = '1px solid #ccc';
                    studentItem.style.borderRadius = '5px';
                    studentItem.draggable = true;
                    studentItem.ondragstart = (event) => {
                        event.dataTransfer.setData('text/plain', student);
                    };
                    groupContainer.appendChild(studentItem);
                });

                groupContainer.ondragover = (event) => {
                    event.preventDefault();
                };

                groupContainer.ondrop = (event) => {
                    event.preventDefault();
                    const student = event.dataTransfer.getData('text/plain');
                    const fromGroup = groups.find(g => g.includes(student));
                    const toGroup = groups[index];

                    if (fromGroup !== toGroup) {
                        fromGroup.splice(fromGroup.indexOf(student), 1);
                        toGroup.push(student);

                        localStorage.setItem(groupStorageKey, JSON.stringify(groups));

                        document.getElementById('groupAdjustmentOverlay').remove();
                        showGroupAdjustment();
                    }
                };

                groupContainerGrid.appendChild(groupContainer);
            });

            container.appendChild(groupContainerGrid);

            const closeButton = document.createElement('button');
            closeButton.textContent = '完成';
            closeButton.style.padding = '10px 20px';
            closeButton.style.marginTop = '20px';
            closeButton.style.border = 'none';
            closeButton.style.borderRadius = '5px';
            closeButton.style.backgroundColor = '#ff7e5f';
            closeButton.style.color = '#fff';
            closeButton.style.cursor = 'pointer';
            closeButton.style.transition = 'background 0.3s ease';
            closeButton.onclick = () => {
                document.getElementById('groupAdjustmentOverlay').remove();
            };
            container.appendChild(closeButton);

            overlay.appendChild(container);
        }

        function renderCalendar() {
            const calendarDays = document.getElementById('calendarDays');
            calendarDays.innerHTML = `
                <div class="calendarHeaderDay">日</div>
                <div class="calendarHeaderDay">一</div>
                <div class="calendarHeaderDay">二</div>
                <div class="calendarHeaderDay">三</div>
                <div class="calendarHeaderDay">四</div>
                <div class="calendarHeaderDay">五</div>
                <div class="calendarHeaderDay">六</div>
                <div class="calendarHeaderDay">統計</div>
            `;
            const firstDayOfMonth = new Date(currentMonth.getFullYear(), currentMonth.getMonth(), 1);
            const lastDayOfMonth = new Date(currentMonth.getFullYear(), currentMonth.getMonth() + 1, 0);
            const firstDayIndex = firstDayOfMonth.getDay();
            const lastDayIndex = lastDayOfMonth.getDay();
            const prevLastDay = new Date(currentMonth.getFullYear(), currentMonth.getMonth(), 0).getDate();
            const lastDay = lastDayOfMonth.getDate();
            const today = new Date();
            let weekDayCount = 0;

            document.getElementById('calendarMonth').textContent = currentMonth.toLocaleDateString('zh-TW', { year: 'numeric', month: 'long' });

            // Previous month dates
            for (let i = firstDayIndex; i > 0; i--) {
                const day = document.createElement('div');
                day.classList.add('calendarDay');
                day.classList.add('prevMonthDay');
                day.textContent = prevLastDay - i + 1;
                calendarDays.appendChild(day);
                weekDayCount++;
            }

            // Current month dates
            for (let i = 1; i <= lastDay; i++) {
                const day = document.createElement('div');
                day.classList.add('calendarDay');
                if (today.getFullYear() === currentMonth.getFullYear() && 
                    today.getMonth() === currentMonth.getMonth() && 
                    today.getDate() === i) {
                    day.classList.add('today');
                }
                const dateKey = `${currentMonth.getFullYear()}-${currentMonth.getMonth() + 1}-${i}`;
                if (scores[dateKey]) {
                    day.classList.add('hasData');
                }
                day.textContent = i;
                day.onclick = () => showDailyScoreSection(i);
                calendarDays.appendChild(day);
                weekDayCount++;
                if (weekDayCount === 7) {
                    const weekSummary = document.createElement('div');
                    weekSummary.classList.add('calendarDay');
                    weekSummary.innerHTML = `<button class="weekSummaryButton" onclick="showWeeklySummary(${i - 6}, ${i})">每週統計</button>`;
                    calendarDays.appendChild(weekSummary);
                    weekDayCount = 0;
                }
            }

            // Next month dates
            for (let i = 1; i < 7 - lastDayIndex; i++) {
                const day = document.createElement('div');
                day.classList.add('calendarDay');
                day.classList.add('nextMonthDay');
                day.textContent = i;
                calendarDays.appendChild(day);
                weekDayCount++;
                if (weekDayCount === 7) {
                    const weekSummary = document.createElement('div');
                    weekSummary.classList.add('calendarDay');
                    weekSummary.innerHTML = `<button class="weekSummaryButton" onclick="showWeeklySummary(${lastDay + i - 6}, ${lastDay + i})">每週統計</button>`;
                    calendarDays.appendChild(weekSummary);
                    weekDayCount = 0;
                }
            }
            updateGroupSettingsButton();
        }

        function changeMonth(months) {
            currentMonth.setMonth(currentMonth.getMonth() + months);
            renderCalendar();
        }

        function showDailyScoreSection(day) {
            currentDay = day;
            document.getElementById('selectedDate').textContent = `日期: ${currentMonth.getFullYear()}${(currentMonth.getMonth() + 1).toString().padStart(2, '0')}${day.toString().padStart(2, '0')}`;
            document.getElementById('calendar').style.display = 'none';
            document.getElementById('header').style.display = 'none';
            document.getElementById('inputSection').style.display = 'block';
            document.getElementById('controlSection').style.display = 'flex';
            updateScoreTables();
        }

        function showScoreSection() {
            document.getElementById('scoreSection').style.display = 'block';
            document.getElementById('groupScoreSection').style.display = 'block';
            document.getElementById('chartSection').style.display = 'none';
        }

        function showChartSection() {
            document.getElementById('scoreSection').style.display = 'none';
            document.getElementById('groupScoreSection').style.display = 'none';
            document.getElementById('chartSection').style.display = 'block';
            renderChart();
        }

        function goBack() {
            document.getElementById('inputSection').style.display = 'none';
            document.getElementById('calendar').style.display = 'block';
            document.getElementById('header').style.display = 'flex';
            location.reload();  // 模擬按下鍵盤F5，重新整理頁面
        }

        function updateScoreTables() {
            const scoreSection = document.getElementById('scoreSection');
            scoreSection.innerHTML = '';
            let currentTable = createScoreTable();
            scoreSection.appendChild(currentTable);
            students.forEach((name, index) => {
                if (index % 10 === 0 && index !== 0) {
                    currentTable = createScoreTable();
                    scoreSection.appendChild(currentTable);
                }
                addRowToTable(currentTable, name, index);
            });
            highlightTopScore();

            const groupScoreSection = document.getElementById('groupScoreSection');
            groupScoreSection.innerHTML = '';
            let currentGroupTable = createGroupScoreTable();
            groupScoreSection.appendChild(currentGroupTable);
            groups.forEach((group, groupIndex) => {
                if (groupIndex % 10 === 0 && groupIndex !== 0) {
                    currentGroupTable = createGroupScoreTable();
                    groupScoreSection.appendChild(currentGroupTable);
                }
                addGroupRowToTable(currentGroupTable, group, groupIndex);
            });
            updateGroupSettingsButton();
        }

        function createScoreTable() {
            const table = document.createElement('table');
            table.className = 'scoreTable';
            const thead = table.createTHead();
            const row = thead.insertRow();
            const thName = document.createElement('th');
            const thAdd = document.createElement('th');
            const thScore = document.createElement('th');
            const thSubtract = document.createElement('th');
            thName.textContent = '姓名';
            thAdd.textContent = '加分';
            thScore.textContent = '得分';
            thSubtract.textContent = '扣分';
            row.appendChild(thName);
            row.appendChild(thAdd);
            row.appendChild(thScore);
            row.appendChild(thSubtract);
            table.createTBody();
            return table;
        }

        function createGroupScoreTable() {
            const table = document.createElement('table');
            table.className = 'groupScoreTable';
            const thead = table.createTHead();
            const row = thead.insertRow();
            const thGroupName = document.createElement('th');
            const thAdd = document.createElement('th');
            const thScore = document.createElement('th');
            const thSubtract = document.createElement('th');
            const thMembers = document.createElement('th');  // Add a new column for group members
            thGroupName.textContent = '組名';
            thAdd.textContent = '加分';
            thScore.textContent = '得分';
            thSubtract.textContent = '扣分';
            thMembers.textContent = '組員';  // Set the header text for group members
            row.appendChild(thGroupName);
            row.appendChild(thAdd);
            row.appendChild(thScore);
            row.appendChild(thSubtract);
            row.appendChild(thMembers);  // Append the new header column
            table.createTBody();
            return table;
        }

        function addRowToTable(table, name, index) {
            const tbody = table.getElementsByTagName('tbody')[0];
            const row = tbody.insertRow();
            const cellName = row.insertCell(0);
            const cellAdd = row.insertCell(1);
            const cellScore = row.insertCell(2);
            const cellSubtract = row.insertCell(3);

            cellName.textContent = name;
            cellAdd.innerHTML = `<button onclick="changeScore('${name}-${index}', 1)">+</button>`;
            const dateKey = `${currentMonth.getFullYear()}-${currentMonth.getMonth() + 1}-${currentDay}`;
            if (!scores[dateKey]) {
                scores[dateKey] = {};
            }
            cellScore.textContent = scores[dateKey][`${name}-${index}`] || 0;
            cellSubtract.innerHTML = `<button onclick="changeScore('${name}-${index}', -1)">-</button>`;
        }

        function addGroupRowToTable(table, group, groupIndex) {
            const tbody = table.getElementsByTagName('tbody')[0];
            const row = tbody.insertRow();
            const cellGroupName = row.insertCell(0);
            const cellAdd = row.insertCell(1);
            const cellScore = row.insertCell(2);
            const cellSubtract = row.insertCell(3);
            const cellMembers = row.insertCell(4);  // Add a new cell for group members

            cellGroupName.textContent = `第 ${groupIndex + 1} 組`;
            cellAdd.innerHTML = `<button onclick="changeGroupScore(${groupIndex}, 1)">+</button>`;
            cellScore.textContent = scores[`${currentMonth.getFullYear()}-${currentMonth.getMonth() + 1}-${currentDay}`]?.[`group-${groupIndex}`] || 0;
            cellSubtract.innerHTML = `<button onclick="changeGroupScore(${groupIndex}, -1)">-</button>`;
            cellMembers.textContent = group.join(', ');  // Display group members
        }

        function changeScore(key, delta) {
            const dateKey = `${currentMonth.getFullYear()}-${currentMonth.getMonth() + 1}-${currentDay}`;
            if (!scores[dateKey]) {
                scores[dateKey] = {};
            }
            scores[dateKey][key] = (scores[dateKey][key] || 0) + delta;
            localStorage.setItem(scoreStorageKey, JSON.stringify(scores));
            updateScoreTables();
        }

        function changeGroupScore(groupIndex, delta) {
            const dateKey = `${currentMonth.getFullYear()}-${currentMonth.getMonth() + 1}-${currentDay}`;
            if (!scores[dateKey]) {
                scores[dateKey] = {};
            }
            const groupKey = `group-${groupIndex}`;
            scores[dateKey][groupKey] = (scores[dateKey][groupKey] || 0) + delta;

            groups[groupIndex].forEach(student => {
                const key = `${student}-${students.indexOf(student)}`;
                scores[dateKey][key] = (scores[dateKey][key] || 0) + delta;
            });

            localStorage.setItem(scoreStorageKey, JSON.stringify(scores));
            updateScoreTables();
        }

        function highlightTopScore() {
            const dateKey = `${currentMonth.getFullYear()}-${currentMonth.getMonth() + 1}-${currentDay}`;
            if (!scores[dateKey]) return;
            const maxScore = Math.max(...Object.values(scores[dateKey]));
            const cells = document.querySelectorAll('.scoreTable td:nth-child(3)');
            cells.forEach(cell => {
                cell.classList.remove('highlight');
                if (parseInt(cell.textContent) === maxScore) {
                    cell.classList.add('highlight');
                }
            });
        }

        function renderChart() {
            const dateKey = `${currentMonth.getFullYear()}-${currentMonth.getMonth() + 1}-${currentDay}`;
            const ctx = document.getElementById('chart').getContext('2d');
            if (chart) {
                chart.destroy();
            }
            chart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: students,
                    datasets: [{
                        label: '得分',
                        data: students.map((name, index) => scores[dateKey][`${name}-${index}`] || 0),
                        backgroundColor: students.map((name, index) => scores[dateKey][`${name}-${index}`] === Math.max(...Object.values(scores[dateKey])) ? 'darkblue' : 'rgba(54, 162, 235, 0.2)'),
                        borderColor: students.map((name, index) => scores[dateKey][`${name}-${index}`] === Math.max(...Object.values(scores[dateKey])) ? 'darkblue' : 'rgba(54, 162, 235, 1)'),
                        borderWidth: 1
                    }]
                },
                options: {
                    scales: {
                        y: {
                            beginAtZero: true
                        },
                        x: {
                            ticks: {
                                autoSkip: false,
                                maxRotation: students.length <= 6 ? 0 : 90,
                                minRotation: 0,
                                font: function(context) {
                                    const width = context.chart.width;
                                    const size = students.length <= 6 ? 14 : Math.round(width / students.length / 1.5);
                                    return {
                                        size: size > 8 ? size : 8,
                                    };
                                }
                            }
                        }
                    }
                }
            });
        }

        function confirmReset() {
            if (confirm("確定要重置所有資料嗎？")) {
                localStorage.removeItem(studentStorageKey);
                localStorage.removeItem(scoreStorageKey);
                localStorage.removeItem(groupStorageKey);
                students = [];
                scores = {};
                groups = [];
                document.getElementById('calendar').style.display = 'block';
                document.getElementById('inputSection').style.display = 'none';
                document.getElementById('studentNamesInput').style.display = 'none';
                document.getElementById('header').style.display = 'flex';
                renderCalendar();
            }
        }

        function showWeeklySummary(startDay, endDay) {
            const summaryData = {};
            for (let i = startDay; i <= endDay; i++) {
                const dateKey = `${currentMonth.getFullYear()}-${currentMonth.getMonth() + 1}-${i}`;
                if (scores[dateKey]) {
                    Object.keys(scores[dateKey]).forEach(key => {
                        summaryData[key] = (summaryData[key] || 0) + scores[dateKey][key];
                    });
                }
            }

            document.getElementById('weeklySummaryOverlay').style.display = 'flex';

            const weeklyScoreSection = document.getElementById('weeklyScoreSection');
            weeklyScoreSection.innerHTML = '';
            let currentTable = createWeeklySummaryTable();
            weeklyScoreSection.appendChild(currentTable);
            const maxScore = Math.max(...Object.values(summaryData));
            students.forEach((name, index) => {
                if (index % 10 === 0 && index !== 0) {
                    currentTable = createWeeklySummaryTable();
                    weeklyScoreSection.appendChild(currentTable);
                }
                addSummaryRowToTable(currentTable, name, index, summaryData, maxScore);
            });
            renderSummaryChart(summaryData);
        }

        function showMonthlySummary() {
            const summaryData = {};
            const lastDay = new Date(currentMonth.getFullYear(), currentMonth.getMonth() + 1, 0).getDate();
            for (let i = 1; i <= lastDay; i++) {
                const dateKey = `${currentMonth.getFullYear()}-${currentMonth.getMonth() + 1}-${i}`;
                if (scores[dateKey]) {
                    Object.keys(scores[dateKey]).forEach(key => {
                        summaryData[key] = (summaryData[key] || 0) + scores[dateKey][key];
                    });
                }
            }

            document.getElementById('weeklySummaryOverlay').style.display = 'flex';

            const weeklyScoreSection = document.getElementById('weeklyScoreSection');
            weeklyScoreSection.innerHTML = '';
            let currentTable = createWeeklySummaryTable();
            weeklyScoreSection.appendChild(currentTable);
            const maxScore = Math.max(...Object.values(summaryData));
            students.forEach((name, index) => {
                if (index % 10 === 0 && index !== 0) {
                    currentTable = createWeeklySummaryTable();
                    weeklyScoreSection.appendChild(currentTable);
                }
                addSummaryRowToTable(currentTable, name, index, summaryData, maxScore);
            });
            renderSummaryChart(summaryData);
        }

        function createWeeklySummaryTable() {
            const table = document.createElement('table');
            table.className = 'scoreTable';
            const thead = table.createTHead();
            const row = thead.insertRow();
            const thName = document.createElement('th');
            const thScore = document.createElement('th');
            thName.textContent = '姓名';
            thScore.textContent = '得分';
            row.appendChild(thName);
            row.appendChild(thScore);
            table.createTBody();
            return table;
        }

        function addSummaryRowToTable(table, name, index, summaryData, maxScore) {
            const tbody = table.getElementsByTagName('tbody')[0];
            const row = tbody.insertRow();
            const cellName = row.insertCell(0);
            const cellScore = row.insertCell(1);

            cellName.textContent = name;
            cellScore.textContent = summaryData[`${name}-${index}`] || 0;

            if (summaryData[`${name}-${index}`] === maxScore) {
                cellName.style.fontWeight = 'bold';
                cellName.style.color = 'red';
            }
        }

        function renderSummaryChart(summaryData) {
            const ctx = document.getElementById('weeklyChart').getContext('2d');
            if (weeklyChart) {
                weeklyChart.destroy();
            }
            weeklyChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: students,
                    datasets: [{
                        label: '得分',
                        data: students.map((name, index) => summaryData[`${name}-${index}`] || 0),
                        backgroundColor: students.map((name, index) => summaryData[`${name}-${index}`] === Math.max(...Object.values(summaryData)) ? 'darkblue' : 'rgba(54, 162, 235, 0.2)'),
                        borderColor: students.map((name, index) => summaryData[`${name}-${index}`] === Math.max(...Object.values(summaryData)) ? 'darkblue' : 'rgba(54, 162, 235, 1)'),
                        borderWidth: 1
                    }]
                },
                options: {
                    scales: {
                        y: {
                            beginAtZero: true
                        },
                        x: {
                            ticks: {
                                autoSkip: false,
                                maxRotation: students.length <= 6 ? 0 : 90,
                                minRotation: 0,
                                font: function(context) {
                                    const width = context.chart.width;
                                    const size = students.length <= 6 ? 14 : Math.round(width / students.length / 1.5);
                                    return {
                                        size: size > 8 ? size : 8,
                                    };
                                }
                            }
                        }
                    }
                }
            });
        }

        function setTheme(theme) {
            currentTheme = theme;
            document.body.style.background = backgroundColors[theme];
            localStorage.setItem(themeStorageKey, theme);
        }

        function exportData() {
            const data = {
                students: students,
                scores: scores,
                groups: groups
            };
            const json = JSON.stringify(data);
            const blob = new Blob([json], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = '706class_data.json';
            a.click();
            URL.revokeObjectURL(url);
        }

        function importData() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = 'application/json';
            input.onchange = function(event) {
                const file = event.target.files[0];
                const reader = new FileReader();
                reader.onload = function(e) {
                    const data = JSON.parse(e.target.result);
                    students = data.students || [];
                    scores = data.scores || {};
                    groups = data.groups || [];
                    localStorage.setItem(studentStorageKey, JSON.stringify(students));
                    localStorage.setItem(scoreStorageKey, JSON.stringify(scores));
                    localStorage.setItem(groupStorageKey, JSON.stringify(groups));
                    renderCalendar();
                };
                reader.readAsText(file);
            };
            input.click();
        }

        function hideWeeklySummary() {
            document.getElementById('weeklySummaryOverlay').style.display = 'none';
        }

        function hasGroupScores() {
            for (const dateKey in scores) {
                for (const key in scores[dateKey]) {
                    if (key.startsWith('group-')) {
                        return true;
                    }
                }
            }
            return false;
        }

        function updateGroupSettingsButton() {
            const groupSettingsButton = document.getElementById('groupSettingsButton');
            if (hasGroupScores()) {
                groupSettingsButton.textContent = '已分組';
            } else {
                groupSettingsButton.textContent = '學生分組';
            }
        }

        window.onbeforeunload = function() {
            localStorage.setItem(studentStorageKey, JSON.stringify(students));
            localStorage.setItem(scoreStorageKey, JSON.stringify(scores));
            localStorage.setItem(groupStorageKey, JSON.stringify(groups));
        };

        window.onload = function() {
            if (students.length > 0) {
                renderCalendar();
                renderChart();
            }
        };
    </script>


<div id="yt_article_summary_widget_wrapper" class="yt_article_summary_widget_wrapper" style="display: none;">
        <div id="yt_article_summary_widget" class="yt_article_summary_widget"><svg style="filter: brightness(0.8);" width="32" height="32" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <mask id="path-1-outside-1_3606_3145" maskUnits="userSpaceOnUse" x="1" y="1" width="22" height="22" fill="black">
                  <rect fill="white" x="1" y="1" width="22" height="22"></rect>
                  <path d="M20.6816 10.1843C20.9588 9.34066 21.0063 8.4399 20.8192 7.57245C20.6321 6.70499 20.217 5.90134 19.6157 5.24216C19.0143 4.58298 18.2478 4.09146 17.393 3.81692C16.5382 3.54238 15.6253 3.49449 14.7459 3.67805C14.1453 3.01747 13.379 2.52468 12.524 2.24931C11.669 1.97394 10.7555 1.92571 9.87559 2.10947C8.99568 2.29324 8.18039 2.70252 7.51181 3.29608C6.84323 3.88965 6.34499 4.64654 6.06725 5.49055C5.18642 5.67292 4.3699 6.08122 3.70003 6.67426C3.03017 7.26731 2.53064 8.02413 2.25182 8.86842C1.97299 9.71271 1.92474 10.6146 2.11192 11.4832C2.2991 12.3517 2.71509 13.1562 3.31795 13.8155C3.09309 14.4899 3.01633 15.2037 3.09278 15.9095C3.16924 16.6154 3.39716 17.2971 3.76139 17.9093C4.30169 18.8351 5.12567 19.568 6.11483 20.0027C7.104 20.4373 8.20738 20.5512 9.26631 20.328C9.74353 20.8568 10.3291 21.2796 10.9844 21.5684C11.6396 21.8571 12.3495 22.0053 13.0672 22.003C14.1516 22.003 15.2081 21.6635 16.0847 21.0334C16.9612 20.4034 17.6125 19.5152 17.9449 18.4968C18.649 18.3539 19.3141 18.0649 19.8962 17.6489C20.4784 17.233 20.9642 16.6997 21.3214 16.0843C21.8585 15.1598 22.0858 14.0915 21.9709 13.032C21.856 11.9724 21.4048 10.9758 20.6816 10.1843ZM13.0798 20.6968C12.191 20.6968 11.3302 20.3894 10.6473 19.828L10.7677 19.7593L14.8029 17.4593C14.9069 17.4047 14.9935 17.3225 15.0528 17.2221C15.1121 17.1216 15.1418 17.0068 15.1386 16.8905V11.2655L16.8427 12.2405C16.8517 12.2441 16.8594 12.2501 16.865 12.2579C16.8706 12.2656 16.8739 12.2748 16.8744 12.2843V16.9343C16.876 17.4289 16.7785 17.9189 16.5875 18.3761C16.3964 18.8333 16.1156 19.2488 15.7611 19.5985C15.4067 19.9482 14.9856 20.2253 14.5222 20.4138C14.0588 20.6023 13.5621 20.6984 13.0608 20.6968H13.0798ZM4.90165 17.2593C4.46164 16.5029 4.3026 15.6189 4.45188 14.7593L4.57224 14.828L8.60749 17.128C8.70379 17.1829 8.81303 17.2118 8.92423 17.2118C9.03543 17.2118 9.14467 17.1829 9.24097 17.128L14.1758 14.3218V16.253C14.1797 16.2608 14.1817 16.2694 14.1817 16.278C14.1817 16.2867 14.1797 16.2953 14.1758 16.303L10.0962 18.628C9.66403 18.8748 9.18685 19.0352 8.69188 19.0999C8.19692 19.1647 7.69387 19.1326 7.21148 19.0055C6.72909 18.8784 6.27681 18.6587 5.88048 18.3591C5.48415 18.0595 5.15154 17.6858 4.90165 17.2593ZM3.83741 8.5843C4.28764 7.82089 4.99655 7.23878 5.83919 6.94055V11.6718C5.83595 11.7857 5.86434 11.8983 5.92128 11.9975C5.97823 12.0966 6.06156 12.1785 6.16227 12.2343L11.0717 15.028L9.36766 16.003C9.34918 16.0092 9.32914 16.0092 9.31065 16.003L5.23106 13.678C4.36041 13.1812 3.72487 12.3642 3.46364 11.4059C3.20242 10.4476 3.33682 9.42624 3.83741 8.56555V8.5843ZM17.8563 11.7968L12.9278 8.9718L14.6319 8.00305C14.6403 7.99741 14.6502 7.99439 14.6604 7.99439C14.6705 7.99439 14.6805 7.99741 14.6889 8.00305L18.7685 10.328C19.3915 10.684 19.8992 11.2072 20.2325 11.8368C20.5659 12.4664 20.7111 13.1764 20.6514 13.8843C20.5916 14.5921 20.3294 15.2687 19.8951 15.8352C19.4608 16.4017 18.8724 16.8349 18.1983 17.0843V12.353C18.1946 12.2391 18.1612 12.1281 18.1013 12.0306C18.0414 11.9332 17.957 11.8527 17.8563 11.7968ZM19.554 9.2968L19.4336 9.2218L15.4047 6.9093C15.3047 6.84846 15.1896 6.81624 15.0721 6.81624C14.9547 6.81624 14.8395 6.84846 14.7396 6.9093L9.8111 9.71555V7.75305C9.8061 7.7445 9.80346 7.7348 9.80346 7.72492C9.80346 7.71505 9.8061 7.70535 9.8111 7.6968L13.897 5.37805C14.5222 5.02257 15.2371 4.85003 15.958 4.88059C16.6789 4.91115 17.3762 5.14356 17.9682 5.55064C18.5601 5.95772 19.0225 6.52265 19.301 7.17939C19.5796 7.83614 19.663 8.55755 19.5413 9.2593L19.554 9.2968ZM8.87989 12.7218L7.1695 11.753C7.15339 11.7405 7.1422 11.7228 7.13782 11.703V7.06555C7.13785 6.35289 7.34371 5.65499 7.73128 5.0536C8.11885 4.45222 8.67209 3.97224 9.32619 3.6699C9.98029 3.36756 10.7082 3.25537 11.4246 3.34647C12.141 3.43757 12.8162 3.7282 13.3712 4.1843L13.2636 4.25305L9.21563 6.55305C9.11158 6.60765 9.02504 6.68981 8.96573 6.79029C8.90642 6.89076 8.87669 7.00557 8.87989 7.1218V12.7218ZM9.80476 10.753L11.9966 9.50305L14.1948 10.753V13.253L11.9966 14.503L9.79843 13.253L9.80476 10.753Z"></path>
                  </mask>
                  <path d="M20.6816 10.1843C20.9588 9.34066 21.0063 8.4399 20.8192 7.57245C20.6321 6.70499 20.217 5.90134 19.6157 5.24216C19.0143 4.58298 18.2478 4.09146 17.393 3.81692C16.5382 3.54238 15.6253 3.49449 14.7459 3.67805C14.1453 3.01747 13.379 2.52468 12.524 2.24931C11.669 1.97394 10.7555 1.92571 9.87559 2.10947C8.99568 2.29324 8.18039 2.70252 7.51181 3.29608C6.84323 3.88965 6.34499 4.64654 6.06725 5.49055C5.18642 5.67292 4.3699 6.08122 3.70003 6.67426C3.03017 7.26731 2.53064 8.02413 2.25182 8.86842C1.97299 9.71271 1.92474 10.6146 2.11192 11.4832C2.2991 12.3517 2.71509 13.1562 3.31795 13.8155C3.09309 14.4899 3.01633 15.2037 3.09278 15.9095C3.16924 16.6154 3.39716 17.2971 3.76139 17.9093C4.30169 18.8351 5.12567 19.568 6.11483 20.0027C7.104 20.4373 8.20738 20.5512 9.26631 20.328C9.74353 20.8568 10.3291 21.2796 10.9844 21.5684C11.6396 21.8571 12.3495 22.0053 13.0672 22.003C14.1516 22.003 15.2081 21.6635 16.0847 21.0334C16.9612 20.4034 17.6125 19.5152 17.9449 18.4968C18.649 18.3539 19.3141 18.0649 19.8962 17.6489C20.4784 17.233 20.9642 16.6997 21.3214 16.0843C21.8585 15.1598 22.0858 14.0915 21.9709 13.032C21.856 11.9724 21.4048 10.9758 20.6816 10.1843ZM13.0798 20.6968C12.191 20.6968 11.3302 20.3894 10.6473 19.828L10.7677 19.7593L14.8029 17.4593C14.9069 17.4047 14.9935 17.3225 15.0528 17.2221C15.1121 17.1216 15.1418 17.0068 15.1386 16.8905V11.2655L16.8427 12.2405C16.8517 12.2441 16.8594 12.2501 16.865 12.2579C16.8706 12.2656 16.8739 12.2748 16.8744 12.2843V16.9343C16.876 17.4289 16.7785 17.9189 16.5875 18.3761C16.3964 18.8333 16.1156 19.2488 15.7611 19.5985C15.4067 19.9482 14.9856 20.2253 14.5222 20.4138C14.0588 20.6023 13.5621 20.6984 13.0608 20.6968H13.0798ZM4.90165 17.2593C4.46164 16.5029 4.3026 15.6189 4.45188 14.7593L4.57224 14.828L8.60749 17.128C8.70379 17.1829 8.81303 17.2118 8.92423 17.2118C9.03543 17.2118 9.14467 17.1829 9.24097 17.128L14.1758 14.3218V16.253C14.1797 16.2608 14.1817 16.2694 14.1817 16.278C14.1817 16.2867 14.1797 16.2953 14.1758 16.303L10.0962 18.628C9.66403 18.8748 9.18685 19.0352 8.69188 19.0999C8.19692 19.1647 7.69387 19.1326 7.21148 19.0055C6.72909 18.8784 6.27681 18.6587 5.88048 18.3591C5.48415 18.0595 5.15154 17.6858 4.90165 17.2593ZM3.83741 8.5843C4.28764 7.82089 4.99655 7.23878 5.83919 6.94055V11.6718C5.83595 11.7857 5.86434 11.8983 5.92128 11.9975C5.97823 12.0966 6.06156 12.1785 6.16227 12.2343L11.0717 15.028L9.36766 16.003C9.34918 16.0092 9.32914 16.0092 9.31065 16.003L5.23106 13.678C4.36041 13.1812 3.72487 12.3642 3.46364 11.4059C3.20242 10.4476 3.33682 9.42624 3.83741 8.56555V8.5843ZM17.8563 11.7968L12.9278 8.9718L14.6319 8.00305C14.6403 7.99741 14.6502 7.99439 14.6604 7.99439C14.6705 7.99439 14.6805 7.99741 14.6889 8.00305L18.7685 10.328C19.3915 10.684 19.8992 11.2072 20.2325 11.8368C20.5659 12.4664 20.7111 13.1764 20.6514 13.8843C20.5916 14.5921 20.3294 15.2687 19.8951 15.8352C19.4608 16.4017 18.8724 16.8349 18.1983 17.0843V12.353C18.1946 12.2391 18.1612 12.1281 18.1013 12.0306C18.0414 11.9332 17.957 11.8527 17.8563 11.7968ZM19.554 9.2968L19.4336 9.2218L15.4047 6.9093C15.3047 6.84846 15.1896 6.81624 15.0721 6.81624C14.9547 6.81624 14.8395 6.84846 14.7396 6.9093L9.8111 9.71555V7.75305C9.8061 7.7445 9.80346 7.7348 9.80346 7.72492C9.80346 7.71505 9.8061 7.70535 9.8111 7.6968L13.897 5.37805C14.5222 5.02257 15.2371 4.85003 15.958 4.88059C16.6789 4.91115 17.3762 5.14356 17.9682 5.55064C18.5601 5.95772 19.0225 6.52265 19.301 7.17939C19.5796 7.83614 19.663 8.55755 19.5413 9.2593L19.554 9.2968ZM8.87989 12.7218L7.1695 11.753C7.15339 11.7405 7.1422 11.7228 7.13782 11.703V7.06555C7.13785 6.35289 7.34371 5.65499 7.73128 5.0536C8.11885 4.45222 8.67209 3.97224 9.32619 3.6699C9.98029 3.36756 10.7082 3.25537 11.4246 3.34647C12.141 3.43757 12.8162 3.7282 13.3712 4.1843L13.2636 4.25305L9.21563 6.55305C9.11158 6.60765 9.02504 6.68981 8.96573 6.79029C8.90642 6.89076 8.87669 7.00557 8.87989 7.1218V12.7218ZM9.80476 10.753L11.9966 9.50305L14.1948 10.753V13.253L11.9966 14.503L9.79843 13.253L9.80476 10.753Z" fill="#828282"></path>
                  <path d="M20.6816 10.1843C20.9588 9.34066 21.0063 8.4399 20.8192 7.57245C20.6321 6.70499 20.217 5.90134 19.6157 5.24216C19.0143 4.58298 18.2478 4.09146 17.393 3.81692C16.5382 3.54238 15.6253 3.49449 14.7459 3.67805C14.1453 3.01747 13.379 2.52468 12.524 2.24931C11.669 1.97394 10.7555 1.92571 9.87559 2.10947C8.99568 2.29324 8.18039 2.70252 7.51181 3.29608C6.84323 3.88965 6.34499 4.64654 6.06725 5.49055C5.18642 5.67292 4.3699 6.08122 3.70003 6.67426C3.03017 7.26731 2.53064 8.02413 2.25182 8.86842C1.97299 9.71271 1.92474 10.6146 2.11192 11.4832C2.2991 12.3517 2.71509 13.1562 3.31795 13.8155C3.09309 14.4899 3.01633 15.2037 3.09278 15.9095C3.16924 16.6154 3.39716 17.2971 3.76139 17.9093C4.30169 18.8351 5.12567 19.568 6.11483 20.0027C7.104 20.4373 8.20738 20.5512 9.26631 20.328C9.74353 20.8568 10.3291 21.2796 10.9844 21.5684C11.6396 21.8571 12.3495 22.0053 13.0672 22.003C14.1516 22.003 15.2081 21.6635 16.0847 21.0334C16.9612 20.4034 17.6125 19.5152 17.9449 18.4968C18.649 18.3539 19.3141 18.0649 19.8962 17.6489C20.4784 17.233 20.9642 16.6997 21.3214 16.0843C21.8585 15.1598 22.0858 14.0915 21.9709 13.032C21.856 11.9724 21.4048 10.9758 20.6816 10.1843ZM13.0798 20.6968C12.191 20.6968 11.3302 20.3894 10.6473 19.828L10.7677 19.7593L14.8029 17.4593C14.9069 17.4047 14.9935 17.3225 15.0528 17.2221C15.1121 17.1216 15.1418 17.0068 15.1386 16.8905V11.2655L16.8427 12.2405C16.8517 12.2441 16.8594 12.2501 16.865 12.2579C16.8706 12.2656 16.8739 12.2748 16.8744 12.2843V16.9343C16.876 17.4289 16.7785 17.9189 16.5875 18.3761C16.3964 18.8333 16.1156 19.2488 15.7611 19.5985C15.4067 19.9482 14.9856 20.2253 14.5222 20.4138C14.0588 20.6023 13.5621 20.6984 13.0608 20.6968H13.0798ZM4.90165 17.2593C4.46164 16.5029 4.3026 15.6189 4.45188 14.7593L4.57224 14.828L8.60749 17.128C8.70379 17.1829 8.81303 17.2118 8.92423 17.2118C9.03543 17.2118 9.14467 17.1829 9.24097 17.128L14.1758 14.3218V16.253C14.1797 16.2608 14.1817 16.2694 14.1817 16.278C14.1817 16.2867 14.1797 16.2953 14.1758 16.303L10.0962 18.628C9.66403 18.8748 9.18685 19.0352 8.69188 19.0999C8.19692 19.1647 7.69387 19.1326 7.21148 19.0055C6.72909 18.8784 6.27681 18.6587 5.88048 18.3591C5.48415 18.0595 5.15154 17.6858 4.90165 17.2593ZM3.83741 8.5843C4.28764 7.82089 4.99655 7.23878 5.83919 6.94055V11.6718C5.83595 11.7857 5.86434 11.8983 5.92128 11.9975C5.97823 12.0966 6.06156 12.1785 6.16227 12.2343L11.0717 15.028L9.36766 16.003C9.34918 16.0092 9.32914 16.0092 9.31065 16.003L5.23106 13.678C4.36041 13.1812 3.72487 12.3642 3.46364 11.4059C3.20242 10.4476 3.33682 9.42624 3.83741 8.56555V8.5843ZM17.8563 11.7968L12.9278 8.9718L14.6319 8.00305C14.6403 7.99741 14.6502 7.99439 14.6604 7.99439C14.6705 7.99439 14.6805 7.99741 14.6889 8.00305L18.7685 10.328C19.3915 10.684 19.8992 11.2072 20.2325 11.8368C20.5659 12.4664 20.7111 13.1764 20.6514 13.8843C20.5916 14.5921 20.3294 15.2687 19.8951 15.8352C19.4608 16.4017 18.8724 16.8349 18.1983 17.0843V12.353C18.1946 12.2391 18.1612 12.1281 18.1013 12.0306C18.0414 11.9332 17.957 11.8527 17.8563 11.7968ZM19.554 9.2968L19.4336 9.2218L15.4047 6.9093C15.3047 6.84846 15.1896 6.81624 15.0721 6.81624C14.9547 6.81624 14.8395 6.84846 14.7396 6.9093L9.8111 9.71555V7.75305C9.8061 7.7445 9.80346 7.7348 9.80346 7.72492C9.80346 7.71505 9.8061 7.70535 9.8111 7.6968L13.897 5.37805C14.5222 5.02257 15.2371 4.85003 15.958 4.88059C16.6789 4.91115 17.3762 5.14356 17.9682 5.55064C18.5601 5.95772 19.0225 6.52265 19.301 7.17939C19.5796 7.83614 19.663 8.55755 19.5413 9.2593L19.554 9.2968ZM8.87989 12.7218L7.1695 11.753C7.15339 11.7405 7.1422 11.7228 7.13782 11.703V7.06555C7.13785 6.35289 7.34371 5.65499 7.73128 5.0536C8.11885 4.45222 8.67209 3.97224 9.32619 3.6699C9.98029 3.36756 10.7082 3.25537 11.4246 3.34647C12.141 3.43757 12.8162 3.7282 13.3712 4.1843L13.2636 4.25305L9.21563 6.55305C9.11158 6.60765 9.02504 6.68981 8.96573 6.79029C8.90642 6.89076 8.87669 7.00557 8.87989 7.1218V12.7218ZM9.80476 10.753L11.9966 9.50305L14.1948 10.753V13.253L11.9966 14.503L9.79843 13.253L9.80476 10.753Z" stroke="#828282" stroke-width="0.2" mask="url(#path-1-outside-1_3606_3145)"></path>
              </svg></div>
        <div id="yt_article_summary_close_button" class="yt_article_summary_close_button">×</div>
    </div></body></html>